geom_line()+
geom_point()+
tema+
scale_x_continuous(breaks=2013:2022)+
labs(title="Promedio de dióxido de azufre en el aire",
subtitle="Por año", caption=caption, y="", x="Año")
data%>%
mutate(year=year(fecha))%>%
group_by(year)%>%
summarize(so2=mean(so2, na.rm=T))%>%
ungroup()%>%
ggplot(aes(x=year, y=so2))+
geom_line()+
geom_point()+
tema
save("Mean_azufre")
data%>%
mutate(year=year(fecha))%>%
group_by(year)%>%
summarize(so2=mean(so2, na.rm=T))%>%
ungroup()%>%
ggplot(aes(x=year, y=so2))+
geom_line()+
geom_point()+
tema+
scale_x_continuous(breaks=2013:2022)+
labs(title="Promedio de dióxido de azufre en el aire",
subtitle="Por año", caption=caption, y="", x="Año")
save("Mean_azufre")
#
# Author: Gina Jiménez
# ------------------------------------------------------------------------------------
# Calidad del aire, Enero 2023
library("pacman")
p_load(tidyverse, foreign, janitor, here, zoo)
#### Funciones ####
mas_cero <- function(x){
x <- ifelse(x>0, 1, 0)
}
### Base Índice de calidad del aire ####
#Primero 2013 a 2018
dir <- "/Users/georginajimenez92/Documents/inputs-datos/0123_calidadaire/indice-calidad/"
names <- dir(dir)
data <- data.frame()
tempo <- read.csv(paste0(dir, names[9]), skip=9, header=F)
View(tempo)
#
# Author: Gina Jiménez
# ------------------------------------------------------------------------------------
# Calidad del aire, Enero 2023
library("pacman")
p_load(tidyverse, foreign, janitor, here, zoo)
#### Funciones ####
mas_cero <- function(x){
x <- ifelse(x>0, 1, 0)
}
### Base Índice de calidad del aire ####
#Primero 2013 a 2018
dir <- "/Users/georginajimenez92/Documents/inputs-datos/0123_calidadaire/indice-calidad/"
names <- dir(dir)
data <- data.frame()
col_names <- c("fecha", "hora", "noro_ozono", "noro_azu", "noro_nitro", "noro_carb",
"noro_pm10", "nore_ozono", "nore_azu", "nore_nitro", "nore_carb",
"nore_pm10", "cen_ozono", "cen_azu", "cen_nitro", "cen_carb",
"cen_pm10", "suro_ozono", "suro_azu", "suro_nitro", "suro_carb",
"suro_pm10", "sure_ozono", "sure_azu", "sure_nitro", "sure_carb", "sure_pm10")
for (i in 1:6) {
tempo <- read.csv(paste0(dir, names[i]), skip=9, header=F)
names(tempo) <- col_names
tempo <- tempo[, 1:27]
data <- bind_rows(data, tempo)
}
rm(tempo)
### Luego 2019 a 2022
col_names <- c("fecha", "hora", "noro_ozono", "noro_azu", "noro_nitro", "noro_carb",
"noro_pm10", "noro_pm25", "nore_ozono", "nore_azu", "nore_nitro", "nore_carb",
"nore_pm10", "nore_pm25", "cen_ozono", "cen_azu", "cen_nitro", "cen_carb",
"cen_pm10", "cen_pm25", "suro_ozono", "suro_azu", "suro_nitro", "suro_carb",
"suro_pm10", "suro_pm25", "sure_ozono", "sure_azu", "sure_nitro", "sure_carb",
"sure_pm10", "sure_pm25")
tempo <- read.csv(paste0(dir, names[9]), skip=9, header=F)
View(tempo)
tempo <- read.csv(paste0(dir, names[9]), skip=9, header=F)
View(tempo)
tempo <- read.csv(paste0(dir, names[9]), skip=9, header=F)
View(tempo)
#
# Author: Gina Jiménez
# ------------------------------------------------------------------------------------
# Calidad del aire, Enero 2023
library("pacman")
p_load(tidyverse, foreign, janitor, here, zoo)
#### Funciones ####
mas_cero <- function(x){
x <- ifelse(x>0, 1, 0)
}
dir <- "/Users/georginajimenez92/Documents/inputs-datos/0123_calidadaire/promedios/azufre/"
names <- dir(dir)
data_so2 <- data.frame()
for (i in 1:10) {
tempo <- read.csv(paste0(dir, names[i]), skip=8, header=T)
data_so2 <- bind_rows(data_so2, tempo)
}
View(data_so2)
dir <- "/Users/georginajimenez92/Documents/inputs-datos/0123_calidadaire/promedios/azufre/"
names <- dir(dir)
data_so2 <- data.frame()
data_so2 <- data.frame()
for (i in 1:10) {
tempo <- read.csv(paste0(dir, names[i]), skip=8, header=T)
data_so2 <- bind_rows(data_so2, tempo)
}
View(data_so2)
data_so2 <- data.frame()
View(data_so2)
dir <- "/Users/georginajimenez92/Documents/inputs-datos/0123_calidadaire/promedios/azufre/"
names <- dir(dir)
names()
names
data_so2 <- data.frame()
for (i in 1:10) {
tempo <- read.csv(paste0(dir, names[i]), skip=8, header=T)
data_so2 <- bind_rows(data_so2, tempo)
}
View(data_so2)
data_so2 <- data.frame()
for (i in 1:10) {
tempo <- read.csv(paste0(dir, names[i]), skip=8, header=T)
tempo <- mutate(fecha=as.Date(date, format="%d/%m/%Y"))
data_so2 <- bind_rows(data_so2, tempo)
}
data_so2 <- data.frame()
for (i in 1:10) {
tempo <- read.csv(paste0(dir, names[i]), skip=8, header=T)
tempo <- mutate(tempo, fecha=as.Date(date, format="%d/%m/%Y"))
data_so2 <- bind_rows(data_so2, tempo)
}
tempo <- read.csv(paste0(dir, names[1]), skip=8, header=T)
View(tempo)
tempo <- mutate(tempo, date=as.Date(date, format="%d/%m/%Y"))
View(tempo)
tempo <- read.csv(paste0(dir, names[2]), skip=8, header=T)
tempo <- mutate(tempo, date=as.Date(date, format="%d/%m/%Y"))
View(tempo)
tempo <- read.csv(paste0(dir, names[3]), skip=8, header=T)
tempo <- mutate(tempo, date=as.Date(date, format="%d/%m/%Y"))
View(tempo)
tempo <- read.csv(paste0(dir, names[4]), skip=8, header=T)
tempo <- mutate(tempo, date=as.Date(date, format="%d/%m/%Y"))
View(tempo)
tempo <- read.csv(paste0(dir, names[5]), skip=8, header=T)
tempo <- mutate(tempo, date=as.Date(date, format="%d/%m/%Y"))
View(tempo)
tempo <- read.csv(paste0(dir, names[6]), skip=8, header=T)
tempo <- mutate(tempo, date=as.Date(date, format="%d/%m/%Y"))
View(tempo)
tempo <- read.csv(paste0(dir, names[6]), skip=8, header=T)
View(tempo)
tempo <- mutate(tempo, date=as.Date(date, format="%d/%m/%Y"))
View(tempo)
tempo <- read.csv(paste0(dir, names[6]), skip=8, header=T)
tempo <- mutate(tempo, date=as.Date(date, format="%d/%m/%Y"))
View(tempo)
tempo <- read.csv(paste0(dir, names[7]), skip=8, header=T)
View(tempo)
tempo <- mutate(tempo, date=as.Date(date, format="%d/%m/%Y"))
View(tempo)
tempo <- read.csv(paste0(dir, names[8]), skip=8, header=T)
tempo <- mutate(tempo, date=as.Date(date, format="%d/%m/%Y"))
View(tempo)
tempo <- read.csv(paste0(dir, names[9]), skip=8, header=T)
tempo <- mutate(tempo, date=as.Date(date, format="%d/%m/%Y"))
tempo <- read.csv(paste0(dir, names[9]), skip=8, header=T)
View(tempo)
tempo <- read.csv(paste0(dir, names[9]), skip=8, header=T)
View(tempo)
tempo <- read.csv(paste0(dir, names[10]), skip=8, header=T)
View(tempo)
dir <- "/Users/georginajimenez92/Documents/inputs-datos/0123_calidadaire/promedios/azufre/"
names <- dir(dir)
data_so2 <- data.frame()
for (i in 1:10) {
tempo <- read.csv(paste0(dir, names[i]), skip=8, header=T)
tempo <- mutate(tempo, date=as.Date(date, format="%d/%m/%Y"))
data_so2 <- bind_rows(data_so2, tempo)
}
View(data)
data_so2 <- mutate(data_so2, fecha=as.Date(date, format="%d/%m/%Y"))%>%
group_by(fecha)%>%
summarize(so2=mean(value, na.rm=T))
View(data_so2)
#### Base promedio de dióxido de azufre ####
dir <- "/Users/georginajimenez92/Documents/inputs-datos/0123_calidadaire/promedios/azufre/"
names <- dir(dir)
data_so2 <- data.frame()
for (i in 1:10) {
tempo <- read.csv(paste0(dir, names[i]), skip=8, header=T)
tempo <- mutate(tempo, date=as.Date(date, format="%d/%m/%Y"))
data_so2 <- bind_rows(data_so2, tempo)
}
data_so2 <- mutate(data_so2, fecha=as.Date(date, format="%d/%m/%Y"))%>%
group_by(fecha)%>%
summarize(so2=mean(value, na.rm=T))
View(data_so2)
dir <- "/Users/georginajimenez92/Documents/inputs-datos/0123_calidadaire/promedios/particulas/"
names <- dir(dir)
data_pm <- data.frame()
for (i in 1:10) {
tempo <- read.csv(paste0(dir, names[i]), skip=8, header=T)
data_pm <- bind_rows(data_pm, tempo)
}
d
dir <- "/Users/georginajimenez92/Documents/inputs-datos/0123_calidadaire/promedios/particulas/"
names <- dir(dir)
data_pm <- data.frame()
for (i in 1:10) {
tempo <- read.csv(paste0(dir, names[i]), skip=8, header=T)
data_pm <- bind_rows(data_pm, tempo)
}
View(data_pm)
dir <- "/Users/georginajimenez92/Documents/inputs-datos/0123_calidadaire/promedios/particulas/"
names <- dir(dir)
data_pm <- data.frame()
for (i in 1:10) {
tempo <- read.csv(paste0(dir, names[i]), skip=8, header=T)
data_pm <- bind_rows(data_pm, tempo)
}
data_pm <- mutate(data_pm, fecha=as.Date(date, format="%d/%m/%Y"))%>%
group_by(fecha, id_parameter)%>%
summarize(value=mean(value, na.rm=T))%>%
pivot_wider(names_from=id_parameter, values_from=value)%>%
clean_names()
data <- left_join(data_so2, data_pm)
View(data)
dir <- "/Users/georginajimenez92/Documents/inputs-datos/0123_calidadaire/promedios/particulas/"
names <- dir(dir)
data_pm <- data.frame()
for (i in 1:10) {
tempo <- read.csv(paste0(dir, names[i]), skip=8, header=T)
data_pm <- bind_rows(data_pm, tempo)
}
View(data_pm)
data_pm <- data.frame()
View(data_pm)
for (i in 1:10) {
tempo <- read.csv(paste0(dir, names[i]), skip=8, header=T)
data_pm <- bind_rows(data_pm, tempo)
}
tempo <- read.csv(paste0(dir, names[10]), skip=8, header=T)
View(tempo)
dir <- "/Users/georginajimenez92/Documents/inputs-datos/0123_calidadaire/promedios/particulas/"
names <- dir(dir)
data_pm <- data.frame()
for (i in 1:10) {
tempo <- read.csv(paste0(dir, names[i]), skip=8, header=T)
data_pm <- bind_rows(data_pm, tempo)
}
View(data_pm)
data_pm <- mutate(data_pm, fecha=as.Date(date, format="%d/%m/%Y"))%>%
group_by(fecha, id_parameter)%>%
summarize(value=mean(value, na.rm=T))%>%
pivot_wider(names_from=id_parameter, values_from=value)%>%
clean_names()
View(data_pm)
data_pm <- data.frame()
for (i in 1:10) {
tempo <- read.csv(paste0(dir, names[i]), skip=8, header=T)
data_pm <- bind_rows(data_pm, tempo)
}
View(data_pm)
data_pm <- mutate(data_pm, fecha=as.Date(date, format="%d/%m/%Y"))
View(data_pm)
View(data_pm)
View(data_pm)
View(data_pm)
View(data_so2)
dir <- "/Users/georginajimenez92/Documents/inputs-datos/0123_calidadaire/promedios/particulas/"
names <- dir(dir)
data_pm <- data.frame()
for (i in 1:10) {
tempo <- read.csv(paste0(dir, names[i]), skip=8, header=T)
data_pm <- bind_rows(data_pm, tempo)
}
data_pm <- mutate(data_pm, fecha=as.Date(date, format="%d/%m/%Y"))%>%
group_by(fecha, id_parameter)%>%
summarize(value=mean(value, na.rm=T))%>%
pivot_wider(names_from=id_parameter, values_from=value)%>%
clean_names()
View(data_pm)
View(data_pm)
dir <- "/Users/georginajimenez92/Documents/inputs-datos/0123_calidadaire/promedios/azufre/"
names <- dir(dir)
data_so2 <- data.frame()
for (i in 1:10) {
tempo <- read.csv(paste0(dir, names[i]), skip=8, header=T)
tempo <- mutate(tempo, date=as.Date(date, format="%d/%m/%Y"))
data_so2 <- bind_rows(data_so2, tempo)
}
data_so2 <- mutate(data_so2, fecha=as.Date(date, format="%d/%m/%Y"))%>%
group_by(fecha)%>%
summarize(so2=mean(value, na.rm=T))
dir <- "/Users/georginajimenez92/Documents/inputs-datos/0123_calidadaire/promedios/particulas/"
names <- dir(dir)
data_pm <- data.frame()
for (i in 1:10) {
tempo <- read.csv(paste0(dir, names[i]), skip=8, header=T)
data_pm <- bind_rows(data_pm, tempo)
}
data_pm <- mutate(data_pm, fecha=as.Date(date, format="%d/%m/%Y"))%>%
group_by(fecha, id_parameter)%>%
summarize(value=mean(value, na.rm=T))%>%
pivot_wider(names_from=id_parameter, values_from=value)%>%
clean_names()
data <- left_join(data_so2, data_pm)
saveRDS(data, here("import-clean/output/base_promedios.rds"))
#### Gráficas sobre promedios ####
data <- readRDS(files$data_promedios)
data%>%
mutate(year=year(fecha))%>%
group_by(year)%>%
summarize(so2=mean(so2, na.rm=T))%>%
ungroup()%>%
ggplot(aes(x=year, y=so2))+
geom_line()+
geom_point()+
tema+
scale_x_continuous(breaks=2013:2022)+
labs(title="Promedio de dióxido de azufre en el aire",
subtitle="Por año", caption=caption, y="", x="Año")
data%>%
mutate(year=year(fecha))%>%
group_by(year)%>%
summarize(so2=median(so2, na.rm=T))%>%
ungroup()%>%
ggplot(aes(x=year, y=so2))+
geom_line()+
geom_point()+
tema+
scale_x_continuous(breaks=2013:2022)+
labs(title="Mediana de dióxido de azufre en el aire",
subtitle="Por año", caption=caption, y="", x="Año")
save("Median_azufre")
names(data)
data%>%
mutate(year=year(fecha))%>%
group_by(year)%>%
summarize(pm10=mean(pm10, na.rm=T))%>%
ungroup()%>%
ggplot(aes(x=year, y=pm10))+
geom_line()+
geom_point()+
tema+
scale_x_continuous(breaks=2013:2022)+
labs(title="Promedio de PM10 en el aire",
subtitle="Por año", caption=caption, y="", x="Año")
#PM10
data%>%
mutate(year=year(fecha))%>%
group_by(year)%>%
summarize(pm10=mean(pm10, na.rm=T))%>%
ungroup()%>%
ggplot(aes(x=year, y=pm10))+
geom_line()+
geom_point()+
tema+
scale_x_continuous(breaks=2013:2022)+
labs(title="Promedio de PM10 en el aire",
subtitle="Por año", caption=caption, y="", x="Año")
save("Mean_PM10")
data%>%
mutate(year=year(fecha))%>%
group_by(year)%>%
summarize(pm10=median(pm10, na.rm=T))%>%
ungroup()%>%
ggplot(aes(x=year, y=pm10))+
geom_line()+
geom_point()+
tema+
scale_x_continuous(breaks=2013:2022)+
labs(title="Mediana de PM10 en el aire",
subtitle="Por año", caption=caption, y="", x="Año")
save("Median_PM10")
#PM2.5
data%>%
mutate(year=year(fecha))%>%
group_by(year)%>%
summarize(pm25=mean(pm25, na.rm=T))%>%
ungroup()%>%
ggplot(aes(x=year, y=pm25))+
geom_line()+
geom_point()+
tema+
scale_x_continuous(breaks=2013:2022)+
labs(title="Promedio de PM2.5 en el aire",
subtitle="Por año", caption=caption, y="", x="Año")
View(data)
#PM2.5
data%>%
mutate(year=year(fecha))%>%
group_by(year)%>%
summarize(pm25=mean(pm2_5, na.rm=T))%>%
ungroup()%>%
ggplot(aes(x=year, y=pm2_5))+
geom_line()+
geom_point()+
tema+
scale_x_continuous(breaks=2013:2022)+
labs(title="Promedio de PM2.5 en el aire",
subtitle="Por año", caption=caption, y="", x="Año")
data%>%
mutate(year=year(fecha))%>%
group_by(year)%>%
summarize(pm2_5=mean(pm2_5, na.rm=T))%>%
ungroup()%>%
ggplot(aes(x=year, y=pm2_5))+
geom_line()+
geom_point()+
tem
data%>%
mutate(year=year(fecha))%>%
group_by(year)%>%
summarize(pm2_5=mean(pm2_5, na.rm=T))%>%
ungroup()%>%
ggplot(aes(x=year, y=pm2_5))+
geom_line()+
geom_point()+
tema
#PM2.5
data%>%
mutate(year=year(fecha))%>%
group_by(year)%>%
summarize(pm2_5=mean(pm2_5, na.rm=T))%>%
ungroup()%>%
ggplot(aes(x=year, y=pm2_5))+
geom_line()+
geom_point()+
tema+
scale_x_continuous(breaks=2013:2022)+
labs(title="Promedio de PM2.5 en el aire",
subtitle="Por año", caption=caption, y="", x="Año")
save("Mean_PM25")
data%>%
mutate(year=year(fecha))%>%
group_by(year)%>%
summarize(pm2_5=median(pm2_5, na.rm=T))%>%
ungroup()%>%
ggplot(aes(x=year, y=pm2_5))+
geom_line()+
geom_point()+
tema+
scale_x_continuous(breaks=2013:2022)+
labs(title="Mediana de PM10 en el aire",
subtitle="Por año", caption=caption, y="", x="Año")
save("Median_PM25")
#
# Author: Gina Jiménez
# ------------------------------------------------------------------------------------
# Calidad del aire, Enero 2023
library("pacman")
p_load(tidyverse, foreign, janitor, here, zoo)
#### Funciones ####
mas_cero <- function(x){
x <- ifelse(x>0, 1, 0)
}
here()
#
# Author: Gina Jiménez
# ------------------------------------------------------------------------------------
# Calidad del aire, Enero 2023
library("pacman")
p_load(tidyverse, foreign, janitor, here, zoo)
#### Funciones ####
mas_cero <- function(x){
x <- ifelse(x>0, 1, 0)
}
dir <- "/Users/georginajimenez92/Documents/inputs-datos/0123_calidadaire/maximos/"
names <- dir(dir)
tempo <- read.csv(paste0(dir, names[1]), skip=9, header=F)
View(tempo)
tempo <- read.csv(paste0(dir, names[1]), skip=1, header=F)
View(tempo)
tempo <- read.csv(paste0(dir, names[1]), skip=1, header=T)
View(tempo)
View(tempo)
View(tempo)
tempo <- read.csv(paste0(dir, names[1]), skip=1, header=T)%>%
clean_names()%>%
select(-x)
View(tempo)
names()
names
#
# Author: Gina Jiménez
# ------------------------------------------------------------------------------------
# Calidad del aire, Enero 2023
library("pacman")
p_load(tidyverse, foreign, janitor, here, zoo)
#### Funciones ####
mas_cero <- function(x){
x <- ifelse(x>0, 1, 0)
}
View(tempo)
tempo$max_so2 <- pmax(tempo$aco:tempo$xal)
tempo[, "max_so2"] <- apply(tempo[, 2:44], 1, max)
View(tempo)
tempo[df =="nr"] <- NA
tempo[tempo =="nr"] <- NA
View(tempo)
tempo[, "max_so2"] <- apply(tempo[, 2:44], 1, max)
View(tempo)
do.call(pmax, c(tempo[2:44], list(na.rm=TRUE)))
names_var <- names(tempo)
